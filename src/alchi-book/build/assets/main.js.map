{"version":3,"file":"main.js","sources":["../../src/js/main.js"],"sourcesContent":["// TODO split into smaller files\n\n\nfunction get_meta() {\n\n  const meta = Array.from(document.querySelectorAll('meta[name]')).reduce((acc, meta) => (\n    Object.assign(acc, { [meta.name]: meta.content })), {});\n\n  meta.lang = document.querySelector('html').lang;\n  //meta.title = document.querySelector('html > head > title').innerText;\n\n  meta.docname = `${meta['basename.de']}.${meta.version}`; // TODO switch language\n\n  document.title = meta.docname;\n\n  meta.filename = `${meta.docname}.html`;\n\n  Object.keys(meta).forEach(k => console.log(`meta: ${k}: ${meta[k]}`));\n\n  return meta;  \n}\n\n// page size. exact values add empty page (TODO why? firefox bug?)\nconst { print_size, print_orient, print_scale, page_x, page_y } =\n  true\n  ? {\n    print_size: 'A4',\n\n    //print_orient: 'portrait',\n    print_orient: 'landscape', // booklet\n\n    print_scale: 1, // no change\n\n    // DIN A5 = one booklet page when printed on A4 sheets\n\n    // TODO you may need to calibrate your printer to get better print results\n\n    //page_x: 147.5, // mm = DIN A5\n    page_x: 149.5, // mm = DIN A5 + 2mm\n\n    //page_y: 209.5, // mm = DIN A5\n    page_y: 211.1, // mm = DIN A5 + 1.6mm (calibrate page offset. TODO why? better solution?)\n\n    // DIN A4\n    //page_x: 209.5, page_y: 296.5, // mm\n\n  }\n  : {\n    // this is broken\n    // TODO scale fonts and SVGs ....\n    // din a4 = 210 x 297 mm2\n    print_size: 'A4', // used for css print settings\n    print_orient: 'portrait',\n    print_scale: Math.sqrt(2), // A5 --> A4\n    page_x: 209.5, page_y: 296.5, // mm\n    // firefox print dialog: A5 = 8.27 x 5.83 inch2 = 211.712 x 149.248 mm2\n  };\n\n// TODO change page layout here\n//const page_margin = { top: 5, right: 5, bottom: 5, left: 5 }; // mm\n//const page_margin = { top: 10, right: 10, bottom: 10, left: 10 }; // mm\n//const page_margin = { top: 5, right: 10, bottom: 5, left: 10 }; // mm\n//const page_margin = { top: 5, bottom: 5, inside: 10, outside: 5 }; // mm \n\n//const offset_top = 0; // calibrate for screen and PDF-print\n//const offset_inside_only = 0; // calibrate for screen and PDF-print\n//const offset_top = 2.75; // calibrate for paper-print\nconst offset_top = 1; // calibrate for paper-print\nconst offset_inside_only = 1.5; // calibrate for paper-print\nconst margin_size = 6; // mm. 5 mm margin -> content is too large for printing area\nconst page_margin = {\n  top: margin_size + offset_top,\n  bottom: margin_size - offset_top,\n  inside: 1.5*margin_size + offset_inside_only,\n  outside: margin_size\n};\n\n//const content_x = page_x - page_margin.left - page_margin.right;\nconst content_x = page_x - page_margin.inside - page_margin.outside;\nconst content_y = page_y - page_margin.top - page_margin.bottom;\n\nconst map_margin = 3;\nconst map_w = 10;\nconst map_a = map_w / 8;\n\nconst map_x_html = content_x/4;\nconst map_y_html = map_x_html;\n\nconst map_x_svg = 4*map_w + 3*map_margin + 4*map_a;\nconst map_y_svg = map_x_svg;\n\nconst scale_svg_html = map_x_svg / map_x_html;\n\nconst table_margin = 4;\n\nconst bgpat_w = content_x / 5 / 4;\n\n// TODO scale with content\n//const font_size = 3.35; // firefox\nconst font_size = 3; // firefox\n\n\nconst font_size_page2 = font_size;\n\nconst font_size_map = 4;\nconst footer_y = font_size * 1.25;\n\n\n\n// TODO use natural color system\n\nconst color = {\n\n  // light2 = lightness 80/100\n  // light = lightness 67/100\n  // dark  = lightness 33/100\n  // dark2 = lightness 20/100\n  map: {\n    // variant: blue=black, yellow=white\n    4: \"#000066\", // dark2 blue = 240deg\n    3: \"#ffff99\", // light2 yellow = 240deg\n    1: \"#ff0000\", // medium red\n    2: \"#00ff00\", // medium green\n    24: \"#00a9a9\", // dark turc\n    23: \"#abff57\", // light lime = 90deg\n    13: \"#ffab57\", // light lime = 90deg\n    14: \"#a800a8\", // dark purple = 300deg\n  },\n\n  map_v2: {\n    // variant: purple=black, lime=white\n    1: \"#a80000\", // dark red = 0deg\n    2: \"#58ff58\", // light green = 120deg\n    3: \"#ffff58\", // light yellow = 60deg\n    4: \"#0000a8\", // dark blue = 240deg\n    //14: \"#a800a8\", // dark purple = 300deg\n    14: \"#660066\", // dark2 purple = 300deg\n    //23: \"#abff58\", // light lime = 90deg\n    23: \"#ccff99\", // light2 lime = 90deg\n    13: \"#ff8000\", // medium orange = 30deg\n    24: \"#00ffff\", // medium turc = 180deg\n  },\n\n  light: {\n    1: \"#ffc0c0\", // light red\n    2: \"#c0ffc0\", // light green\n    3: \"#ffff80\", // light yellow\n    4: \"#c0c0ff\", // light blue\n\n    13: \"#ffdfc0\", // light orange\n    24: \"#c0ffff\", // light turc\n    14: \"#ffc0ff\", // light purple\n    23: \"#dfffc0\", // light lime\n  },\n\n  dark: {\n    1: \"#800000\", // dark red\n    2: \"#008000\", // dark green\n    3: \"#808000\", // dark yellow\n    4: \"#000080\", // dark blue\n  },\n\n  text: {\n    1: \"#ff0000\", // red\n    2: \"#008000\", // dark green\n    3: \"#b2b200\", // dark yellow (35% lightness)\n    //3: \"#cdcd00\", // dark yellow (40% lightness) -> too light on white ground\n    4: \"#0000ff\", // blue\n  },\n\n  medium: {\n    1: \"#ff0000\", // red\n    2: \"#00ff00\", // green\n    3: \"#ffff00\", // yellow\n    4: \"#0000ff\", // blue\n    \n    // deviations from \"exact\" values come from print color matching\n    // printer = canon G5000\n\n    //13: \"#ff8000\", // orange 30deg\n    13: \"#ff9100\", // orange 34deg\n\n    //24: \"#00ffff\", // turc 180deg\n    24: \"#00ffee\", // turc 176deg\n    \n    //14: \"#ff00ff\", // purple 300deg\n    14: \"#ea00ff\", // purple 295deg\n\n    //23: \"#80ff00\", // lime 90deg\n    23: \"#aaff00\", // lime 80deg\n    \n  },\n\n};\n\n\n//color.map = color.medium;\n\ncolor.map.A = color.map[1];\ncolor.map.B = color.map[2];\ncolor.map.C = color.map[3];\ncolor.map.D = color.map[4];\n\n// old\nconst opposite = {\n  1: 2,\n  2: 1,\n  3: 4,\n  4: 3,\n  \"A\": \"B\",\n  \"B\": \"A\",\n  \"C\": \"D\",\n  \"D\": \"C\",\n};\n\n\n\n// escape hex color for svg inline data url\nfunction sesc(s) {\n  return s.replace(\"#\", \"%23\");\n}\n\n// define css colors: --medium1: red;\nfunction cssVarsOfColorMap(mapname){\n  const mapval = color[mapname];\n  return Object.keys(mapval).reduce((acc, key) => {\n    return acc + \"--\" + mapname + key + \": \" + mapval[key] + \";\\n\";\n  }, \"\");\n}\n\n\n\n// dashed border\nconst dash_length = 6;\n\n\n\n\n\n\nfunction setStyle(key, styleString) {\n  const id = `${key}-style`;\n  const style = document.querySelector(`#${id}`) || (\n    (() => {\n      const style = document.createElement('style');\n      style.id = id;\n      document.querySelector('head').appendChild(style);\n      return style;\n    })()\n  );\n  style.innerHTML = styleString;\n}\n\n\n\nfunction setRootStyle() {\n\n  setStyle('root', `\n\n    /* set css variables */\n    :root {\n\n      --print_size: ${print_size};\n      --print_scale: ${print_scale};\n\n      --font-size: ${font_size}mm;\n      /* TODO use points? like 10pt\n        for better print quality? */\n\n      --page-width: ${page_x}mm;\n      --page-height: ${page_y}mm;\n\n      --page-width-base: ${page_x}mm;\n      --page-height-base: ${page_y}mm;\n\n      --page-margin-top: ${page_margin.top}mm;\n      --page-margin-bottom: ${page_margin.bottom}mm;\n\n      --page-margin-inside: ${page_margin.inside}mm;\n      --page-margin-outside: ${page_margin.outside}mm;\n\n      ${cssVarsOfColorMap(\"light\")}\n      ${cssVarsOfColorMap(\"dark\")}\n      ${cssVarsOfColorMap(\"medium\")}\n      ${cssVarsOfColorMap(\"text\")}\n\n    }\n  `);\n}\n\n\n\nfunction setPrintStyle(props = {}) {\n\n  console.log(`setPrintStyle: print_orient -> ${props.print_orient || print_orient}`);\n  setStyle('print', `\n\n    /* print settings */\n    /* css variables dont work here */\n    @page {\n      margin: 0; /* no print margin */\n      size: ${props.print_size || print_size} ${props.print_orient || print_orient};\n      /* workaround for broken pattern-offsets in pdfnup/bookletimposer TODO verify */\n      body {transform: scale(${props.print_scale || print_scale});\n    }\n\n  `);\n}\n\n\n\n// init\nsetRootStyle();\nsetPrintStyle();\n\n\n\n// alchi.js\n\n// age sense move gender, origin 11\n// signs: 0 = same, 1 = diff\n// these factors are XOR-ed with the origin asmg\nconst ac_bits_asmg_11 = [\n    0b1001, 0b0111, 0b1011, 0b0101,\n    0b1110, 0b0000, 0b1100, 0b0010,\n    0b1101, 0b0011, 0b1111, 0b0001,\n    0b1010, 0b0100, 0b1000, 0b0110,\n];\n\n// XOR factors for \"key of 10 friends\" aka \"double pallas\"\n// five bits! XOR only last three bits!\n//\n// typeList index vs position in double-pallas\n//\n//   0 1 2 3 // parents\n//   4  5  6 // same age\n//   7 8 9 A // kids\n\nconst ac_bits_aasmg_double_pallas = [\n    0b01001, 0b01110, 0b01100, 0b01111, // D3 B4  B2 D4\n    0b10111,    0b10000,       0b10011, // M4   F3   M1\n    0b00001, 0b00110, 0b00100, 0b00111, // A3 C4  C2 A4\n];\n\n/*\n// young age: aa = 00\nconst C3 = 0b0000, A3 = 0b0001, C1 = 0b0010, A1 = 0b0011;\nconst C2 = 0b0100, A2 = 0b0101, C4 = 0b0110, A4 = 0b0111;\n// old age: aa = 01\nconst B3 = 0b1000, D3 = 0b1001, B1 = 0b1010, D1 = 0b1011;\nconst B2 = 0b1100, D2 = 0b1101, B4 = 0b1110, D4 = 0b1111;\n// no age: aa = 10 (five bits)\nconst F3 = 0b10000, M3 = 0b10001, F1 = 0b10010, M1 = 0b10011;\nconst F2 = 0b10100, M2 = 0b10101, F4 = 0b10110, M4 = 0b10111;\n*/\n\n\n\nfunction get_bit(num, idx) {\n    return (num & (1 << idx)) >> idx;\n}\n\n\n\nfunction decode_bitstring(asmg) {\n    return parseInt(asmg, 2);\n}\n\n\n\nfunction ac_xor(factor, list) {\n    return list.map(function (n) {\n        return factor ^ n\n    })\n}\n\n\n\n// letters of the four dimensions\nconst letter_asmg = [\n    ['S', 'L'], // age   = Short  or Long\n    ['E', 'I'], // sense = Extra  or Intro\n    ['N', 'P'], // move  = Neuro  or Psycho\n    ['F', 'M'], // gen   = Female or Male\n]\n\n\n\n// element = sense + move\nconst element = [\n    [\n      '3', // _00_ = EN = 3\n      '1', // _01_ = EP = 1\n    ], [\n      '2', // _10_ = IN = 2\n      '4', // _11_ = IP = 4\n    ],\n]\n\n\n\n// body = age + gender\nconst element_outside = [\n    [\n      'C', // 0__0 = SF = C\n      'A', // 0__1 = SM = A\n    ], [\n      'B', // 1__0 = LF = B\n      'D', // 1__1 = LM = D\n    ],\n]\n\n\n\nconst idxFromDim = {\n  'A': 0,\n  'S': 1,\n  'M': 2,\n  'G': 3,\n\n  'a': 0,\n  's': 1,\n  'm': 2,\n  'g': 3,}\n\n\nfunction getDimBit(asmg, dim) {\n  //global idxFromDim\n  return asmg[idxFromDim[dim]]\n}\n\nfunction letterFromASMG(dim, asmg) { //TODO change to (asmg, dim)\n  // ASMG\n  const i = idxFromDim[dim]\n  //document.write('dim '+dim+'   idx '+i)\n  if (i !== undefined) {\n    return letter_asmg[i][asmg[i]]\n  }\n  // element\n  if (dim == 'E' || dim == 'e') {\n    return element[asmg[1]][asmg[2]]\n  }\n  // outside element = Body = material = family role\n  if (dim == 'B' || dim == 'b') {\n    return element_outside[asmg[0]][asmg[3]]\n  }\n}\n\n\n\n/*\nif(Array.prototype.contains) {\n  console.warn(\"Overriding existing Array.prototype.contains. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code.\");\n}\n*/\nArray.prototype.contains = function(needle) {\n  return this.indexOf(needle) !== -1\n};\n\n// modulo function, also for negative numbers\nNumber.prototype.mod = function(n) {\n    return ((this%n)+n)%n\n}\n\n\n\n// body + element = asmg\n// young age: aa = 00\nconst C3 = 0b0000;\nconst A3 = 0b0001;\nconst C1 = 0b0010;\nconst A1 = 0b0011;\nconst C2 = 0b0100;\nconst A2 = 0b0101;\nconst C4 = 0b0110;\nconst A4 = 0b0111;\n// old age: aa = 01\nconst B3 = 0b1000;\nconst D3 = 0b1001;\nconst B1 = 0b1010;\nconst D1 = 0b1011;\nconst B2 = 0b1100;\nconst D2 = 0b1101;\nconst B4 = 0b1110;\nconst D4 = 0b1111;\n// no age: aa = 10\nconst F3 = 0b10000;\nconst M3 = 0b10001;\nconst F1 = 0b10010;\nconst M1 = 0b10011;\nconst F2 = 0b10100;\nconst M2 = 0b10101;\nconst F4 = 0b10110;\nconst M4 = 0b10111;\n\n\n\n\nfunction add_footers() {\n  // add page footers\n  const page_array = Array.from(document.querySelectorAll('.page-container'));\n  const num_pages = page_array.length;\n  const booklet_last_idx = (Math.ceil(num_pages / 4) * 4) - 1;\n  page_array.forEach((page_div, page_idx) => {\n    if (page_idx == 0 || page_idx == booklet_last_idx) return; // skip first and last page\n    const span_page = `<span>Seite ${page_idx + 1}</span>`;\n    const span_license = `<span>${meta['license.shortname']}</span>`;\n    //const span_title = `<span>${meta.filename}</span>`;\n    const span_title = (page_idx % 2 == 0)\n      ? `<span class=\"url\">${meta.filename}</span>`\n      : `<span class=\"url\">${meta.homepage}</span>`\n    ;\n\n    if (page_idx % 2 == 1) {\n      page_div.innerHTML += `\n        <div class=\"footer\">\n          ${span_page}\n          ${span_license}\n          ${span_title}\n        </div>\n      `;\n    } else {\n      page_div.innerHTML += `\n        <div class=\"footer\">\n          ${span_title}\n          ${span_license}\n          ${span_page}\n        </div>\n      `;\n    }\n  });\n}\n\n\n\nvar current_lang = 'en';\n\nfunction set_language(lang) {\n  //<div class=\"fragment\">\n  \n  const languages = new Set(meta.languages.split(' ')); // TODO move to init\n\n  if (!languages.has(lang)) {\n    const shortLang = (lang || '').split('-')[0];\n    if (languages.has(shortLang)) lang = shortLang;\n    else lang = 'en'; // fallback\n  }\n\n  current_lang = lang;\n\n  document.querySelectorAll('.langs').forEach(fragment => {\n    const children = Array.from(fragment.children);\n    const fragmentLanguages = children.reduce((acc, node) => {\n      if (node.lang) acc.add(node.lang);\n      return acc;\n    }, new Set());\n    if (fragment.localName == 'tr') {\n      console.dir(fragment);\n    }\n    //console.dir(fragment);\n    if (fragmentLanguages.has(lang)) {\n      children.forEach(node => {\n        if (node.lang) node.style.display = 'none';\n      });\n      children.forEach(node => {\n        if (node.lang == lang) node.style.display = ''; // TODO inline-block?\n      });\n    }\n  });\n\n\n  document.querySelectorAll('.language-menu button').forEach(b => b.classList.remove('active'));\n  document.querySelector('#language-button-'+lang).classList.add('active');\n\n}\n\n\n\nlet meta;\nlet query;\n\n\n\nfunction toggleModal(id, action = null) {\n  const target = document.getElementById(id);\n  if (!target) return console.error(`modal ${id} not found`);\n  if (action == 'open') target.classList.add('show');\n  else if (action == 'close') target.classList.remove('show');\n  else target.classList.toggle('show');\n}\nfunction openModal(id) {\n  toggleModal(id, 'open');\n}\nfunction closeModal(id) {\n  toggleModal(id, 'close');\n}\nwindow.openModal = openModal; // global\nwindow.closeModal = closeModal; // global\n\n\n\nfunction add_language_menu() {\n  document.querySelector('.language-menu').innerHTML = meta.languages.split(/\\s+/).map(lang =>\n    `<button class=\"language-button\" id=\"language-button-${lang}\" onclick=\"add_query({ lang: '${lang}' })\">${lang}</button>`\n  ).join('\\n');\n  /* not working. why?\n  const langMenu = document.querySelector('.language-menu');\n  meta.languages.split(/\\s+/).forEach(lang => {\n    const button = document.createElement('button');\n    button.classList.add('language-button');\n    button.id = `language-button-${lang}`;\n    button.onclick = (event) => {\n      console.log('onclick', event.target)\n      add_query({ lang })\n    };\n    button.innerHTML = lang;\n    langMenu.appendChild(button);\n  })\n  */\n\n  // scroll to change language\n\n  /* not working. (why??)\n  document.querySelector('.language-menu').addEventListener('wheel', event => {\n    console.log('menu wheel ' + event.deltaY);\n  });\n  */\n\n  const lang_list = meta.languages.split(/\\s+/);\n  document.querySelector('#screen-menu').addEventListener('wheel', event => {\n    if (event.target.classList.contains('language-button')) {\n      event.preventDefault();\n      const sign = Math.sign(event.deltaY);\n      const next_lang = lang_list[(lang_list.indexOf(current_lang) + sign) % lang_list.length];\n      set_language(next_lang);\n    }\n  });\n\n}\n\n\n\nfunction make_booklet() {\n\n  const page_list = document.querySelectorAll('.page-container');\n\n  const num_pages = page_list.length;\n  const num_sheets = Math.ceil(num_pages / 4);\n\n  //console.log(`${num_sheets} sheets + ${num_pages} pages + ${4*num_sheets} print-pages`);\n\n  function sheet_of_page(page_idx) {\n    // global: num_sheets\n    // return: sheet_idx\n    const print_pages = num_sheets * 4;\n    if (page_idx < print_pages/2) {\n      return Math.floor(page_idx/2);\n    }\n    else if (print_pages/2 <= page_idx && page_idx <= print_pages/2+1) {\n      return Math.floor((page_idx - 2)/2);\n    }\n    else {\n      return Math.floor((print_pages - page_idx - 1)/2);\n    }\n  }\n  //console.log(Array.from({ length: num_pages }).map((_, i) => `${i} -> ${sheet_of_page(i)}`).join('\\n'))\n\n  function is_right_page(page_idx) {\n    return (page_idx + 1) % 2;\n  }\n\n  function is_sheet_back(page_idx) {\n    const print_pages = num_sheets * 4;\n    if (page_idx < print_pages/2) {\n      return page_idx % 2;\n    }\n    else {\n      return (page_idx + 1) % 2;\n    }\n  }\n  //console.log(Array.from({ length: num_pages }).map((_, i) => `${i} -> ${is_sheet_back(i)}`).join('\\n'))\n\n  function is_page_center_left(page_idx) {\n    const print_pages = num_sheets * 4;\n    return page_idx == print_pages/2 - 1;\n  }\n\n  for (const [page_idx, page] of page_list.entries()) {\n    const page_num = page_idx + 1;\n\n    const top_idx = sheet_of_page(page_idx) * 2 + is_sheet_back(page_idx);\n    const left_idx = is_right_page(page_idx);\n    //console.log(`page ${page_num}: ${top_idx} top + ${left_idx} left. ${is_sheet_back(page_idx)} back. ${is_right_page(page_idx)} right`);\n    page.style.gridColumn = `${left_idx+1}`;\n    page.style.gridRow = `${top_idx+1}`;\n    \n    if (is_page_center_left(page_idx)) {\n      page.classList.add('booklet-center-left');\n    }\n  }\n\n  document.querySelector('#pages-container').classList.add('booklet-grid');\n\n}\n\n\n\nfunction make_twopage() {\n\n  const page_list = document.querySelectorAll('.page-container');\n\n  const num_pages = page_list.length;\n\n  function sheet_of_page(page_idx) {\n    return Math.floor((page_idx + 1)/2);\n  }\n\n  function is_right_page(page_idx) {\n    return (page_idx + 1) % 2;\n  }\n\n  //console.log(Array.from({ length: num_pages }).map((_, i) => `sheet_of_page: ${i} -> ${sheet_of_page(i)}`).join('\\n'))\n  //console.log(Array.from({ length: num_pages }).map((_, i) => `is_right_page: ${i} -> ${is_right_page(i)}`).join('\\n'))\n\n  for (const [page_idx, page] of page_list.entries()) {\n    const page_num = page_idx + 1;\n\n    //const top_idx = sheet_of_page(page_idx) * 2 + is_sheet_back(page_idx);\n    const top_idx = sheet_of_page(page_idx);\n    const left_idx = is_right_page(page_idx);\n    //console.log(`page ${page_num}: ${top_idx} top + ${left_idx} left. ${is_sheet_back(page_idx)} back. ${is_right_page(page_idx)} right`);\n    page.style.gridColumn = `${left_idx+1}`;\n    page.style.gridRow = `${top_idx+1}`;\n  }\n\n  document.querySelector('#pages-container').classList.add('booklet-grid');\n\n}\n\n\n\nconst layoutData = {\n\n  twopage: {\n    name: 'Two Page',\n    set: () => {\n      document.querySelector('#pages-container').classList.add('twopage-grid');\n      document.querySelector('#layout-button-twopage').classList.add('active');\n      make_twopage();\n    },\n  },\n\n  booklet: {\n    name: 'Booklet',\n    set: () => {\n      document.querySelector('#pages-container').classList.add('booklet-grid');\n      document.querySelector('#layout-button-booklet').classList.add('active');\n      make_booklet();\n    },\n  },\n\n  linear: {\n    name: 'Linear',\n    set: () => {\n      document.querySelector('#layout-button-linear').classList.add('active');\n    },\n  },\n};\n\n\n\nconst state = {\n  auditMode: false,\n  showFiles: false,\n};\n\nfunction handleChangeAuditMode(target) {\n  //console.dir(event);\n  state.auditMode = target.checked;\n  //console.log(`audit mode: target.checked = ${target.checked}`);\n  if (state.auditMode) {\n    document.querySelector('#pages-container').classList.add('audit-mode');\n    setPrintStyle({ print_orient: 'portrait' });\n    // TODO force \"linear\" layout\n  }\n  else {\n    document.querySelector('#pages-container').classList.remove('audit-mode');\n    setPrintStyle(); // reset\n  }\n}\nwindow.handleChangeAuditMode = handleChangeAuditMode; // global\n\n// TODO add \"two language\" layout: compare two languages side by side\n\n\n\nfunction handleChangeShowFiles(target) {\n  state.showFiles = target.checked;\n  if (state.showFiles) {\n    document.querySelector('#pages-container').classList.add('show-files');\n  }\n  else {\n    document.querySelector('#pages-container').classList.remove('show-files');\n  }\n}\nwindow.handleChangeShowFiles = handleChangeShowFiles; // global\n\n\n\nfunction add_layout_menu() {\n  document.querySelector('.layout-menu').innerHTML = (\n    Object.entries(layoutData).map(([layoutKey, layout]) => {\n      return `<button id=\"layout-button-${layoutKey}\" onclick=\"add_query({ layout: '${layoutKey}' })\">${layout.name}</button>`\n    }).join('\\n')\n    +\n    `<label id=\"audit-mode-button\"><input onChange=\"handleChangeAuditMode(this)\" type=\"checkbox\" id=\"audit-mode-checkbox\"/> Audit Mode</label>`\n    +\n    `<label id=\"show-files-button\"><input onChange=\"handleChangeShowFiles(this)\" type=\"checkbox\" id=\"show-files-checkbox\"/> Show Files</label>`\n  );\n\n  /* not working ... probably setting innerHTML is (slightly) async\n  function handleChangeAuditMode(event) {\n    console.log(`audit mode: event.target.checked = ${event.target.checked}`);\n  }\n  const auditModeCheckbox = document.querySelector('#audit-mode-checkbox')\n  auditModeCheckbox.onchange = handleChangeAuditMode;\n  */\n}\n\n\n\n/*\n  <a id=\"layout-button-booklet\" href=\"#layout=booklet\" class=\"layout-button\">Booklet</a>\n  <a id=\"layout-button-twopage\" href=\"#layout=twopage\" class=\"layout-button active\">Two Page</a>\n  <a id=\"layout-button-linear\" href=\"#layout=linear\" class=\"layout-button\">Linear</a>\n*/\n\n\n\n\n// TODO listen for hashchange event\n// TODO add function set_query, add_query\n\nfunction add_query(obj) {\n  //console.log('add_query', obj)\n  const new_query = Object.assign(query, obj);\n  document.location.hash = '#' + Object.keys(new_query).map(k => {\n    return k + '=' + new_query[k];\n  }).join('&');\n}\nwindow.add_query = add_query; // global\n\nfunction get_query() {\n  const query = Object.fromEntries(\n    document.location.hash.slice(1).split('&').map(kv => {\n      const i = kv.indexOf('=');\n      const k = kv.slice(0, i);\n      const v = kv.slice(i + 1);\n      return [k, v];\n    })\n    .filter(kv => Boolean(kv[0]))\n  );\n  return query;\n}\n\n\n\n// https://stackoverflow.com/a/62700928/10440128\n// restore cursor position after edit\nclass Cursor {\n  static getCurrentCursorPosition(parentElement) {\n      var selection = window.getSelection(),\n          charCount = -1,\n          node;\n      \n      if (selection.focusNode) {\n          if (Cursor._isChildOf(selection.focusNode, parentElement)) {\n              node = selection.focusNode; \n              charCount = selection.focusOffset;\n              \n              while (node) {\n                  if (node === parentElement) {\n                      break;\n                  }\n\n                  if (node.previousSibling) {\n                      node = node.previousSibling;\n                      charCount += node.textContent.length;\n                  } else {\n                      node = node.parentNode;\n                      if (node === null) {\n                          break;\n                      }\n                  }\n              }\n          }\n      }\n      \n      return charCount;\n  }\n  \n  static setCurrentCursorPosition(chars, element) {\n      if (chars >= 0) {\n          var selection = window.getSelection();\n          \n          let range = Cursor._createRange(element, { count: chars });\n\n          if (range) {\n              range.collapse(false);\n              selection.removeAllRanges();\n              selection.addRange(range);\n          }\n      }\n  }\n  \n  static _createRange(node, chars, range) {\n      if (!range) {\n          range = document.createRange()\n          range.selectNode(node);\n          range.setStart(node, 0);\n      }\n\n      if (chars.count === 0) {\n          range.setEnd(node, chars.count);\n      } else if (node && chars.count >0) {\n          if (node.nodeType === Node.TEXT_NODE) {\n              if (node.textContent.length < chars.count) {\n                  chars.count -= node.textContent.length;\n              } else {\n                  range.setEnd(node, chars.count);\n                  chars.count = 0;\n              }\n          } else {\n              for (var lp = 0; lp < node.childNodes.length; lp++) {\n                  range = Cursor._createRange(node.childNodes[lp], chars, range);\n\n                  if (chars.count === 0) {\n                  break;\n                  }\n              }\n          }\n      } \n\n      return range;\n  }\n  \n  static _isChildOf(node, parentElement) {\n      while (node !== null) {\n          if (node === parentElement) {\n              return true;\n          }\n          node = node.parentNode;\n      }\n\n      return false;\n  }\n}\n\n\n\ndocument.body.onload = function handle_body_loaded() {\n\n  console.log('body loaded');\n\n  meta = get_meta();\n  query = get_query();\n\n  add_language_menu();\n  add_layout_menu();\n\n  const userLang = query.lang || navigator.language || navigator.userLanguage;\n  set_language(userLang); // must run after add_layout_menu\n\n\n\n  add_footers();\n\n  // attached/inlined SVG files to have only one HTML file\n  // TODO make SVGs smaller, inkscape is too verbose\n\n  // TODO move all this code to functions\n\n  //color = {};\n  color.middle = {};\n  if (1) {\n    // variant: eigencolor is middle\n    color.middle.fire = \"#ff0000\";\n    color.middle.earth = \"#00ff00\";\n    color.middle.air = \"#ffff00\";\n    color.middle.water = \"#0000ff\";\n  } else {\n    // variant: gegencolor is middle\n    color.middle.fire = \"#00ff00\";\n    color.middle.earth = \"#ff0000\";\n    color.middle.air = \"#0000ff\";\n    color.middle.water = \"#ffff00\";\n  }\n\n  // TODO verify leg positions. who has x-legs? wo has o-legs?\n  // current variant: 14 have x-legs and 23 have o-legs\n  // weak legs = x legs, strong legs = o legs\n\n\n\n  // post process\n\n  // transform custom element <nw>content</nw>\n  Array.from(document.getElementsByTagName(\"nw\")).forEach(e => {\n    e.outerHTML = '<span class=\"nowrap-element\">' + e.innerHTML + '</span>';\n  });\n\n  // replace innerHTML in all document nodes\n  // https://stackoverflow.com/a/41886794/10440128\n  function replaceOnDocument(pattern, string, target = document.body) {\n    [ target, ...target.querySelectorAll(\n      \"*:not(script):not(noscript):not(style)\")\n    ].forEach(({ childNodes: [...nodes] }) => nodes.map(node => {\n      if (node.nodeType === document.ELEMENT_NODE) {\n        node.innerHTML = node.innerHTML.replace(pattern, string);\n  }}));};\n\n  // XO = X and square\n  document.querySelectorAll('pre.xo').forEach(pre => {\n    pre.innerHTML = pre.innerHTML\n      //.replace(/x/g, '&xmark;') // too broad\n      //.replace(/x/g, 'X')\n      .replace(/o/g, '&square;')\n    ;\n  });\n\n  // XO diagonal = plus and diamond/rhombus\n  document.querySelectorAll('pre.xod').forEach(pre => {\n    pre.innerHTML = pre.innerHTML\n      //.replace(/\\+/g, '+')\n      //.replace(/\\+/g, '<span class=\"plus-sign\">&#x2A2F;</span>') // xmark + rotate 45deg\n      .replace(/\\+/g, '<span class=\"plus-sign\">+</span>')\n      \n      .replace(/o/g, '<span class=\"diamond-sign\">&diamond;</span>')\n      //.replace(/o/g, '<span class=\"diamond-sign\">&#x25A1;</span>') // square + rotate 45deg\n    ;\n  });\n\n\n\n  // &xmark; = ⨯\n  //replaceOnDocument(/&xmark;/g, '<span class=\"xmark-sign\">&#x2A2F;</span>');\n  replaceOnDocument(/&amp;xmark;/g, '<span class=\"xmark-sign\">&#x2A2F;</span>');\n\n  // &square; = □\n  replaceOnDocument(/&square;/g, '<span class=\"square-sign\">&#x25A1;</span>');\n\n  // WHITE DIAMOND (U+25C7)\n  //replaceOnDocument(/&diamond;/g, '<span class=\"diamond-sign\">&#x25C7;</span>');\n\n  // &rarr; = →\n  //replaceOnDocument(/&rarr;/g, '<span class=\"rarr\">&rarr;</span>');\n  // not working. why?\n\n  //    width=\"${120 * 0.5}mm\" height=\"${120 * 0.5}mm\"\n\n  var svg_pallas_sign = `\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 220 220\"\n    >\n      <g transform=\"translate(110, 110)\">\n        <path fill=\"none\" stroke=\"black\" stroke-width=\"12\" stroke-linejoin=\"round\" stroke-linecap=\"round\" d=\"\n          M0+0 l50-50 l-50-50 l-50+50 z\n          M0+0 v100\n          M-50+50 h100\n        \"/>\n      </g>\n    </svg>\n  `;\n  document.querySelectorAll('div.pallas-sign').forEach(div => div.innerHTML = svg_pallas_sign);\n\n\n\n  // variant 1\n  // pro:\n  //  * air = white = endomorph, hairless. yellow is virtual color in human nervous system (receptors detect red green blue)\n  //  * water = black = ectomorph, hairy\n  var div_eight_colors = document.getElementById('div_eight_colors');\n  /*\n  var color_name = [\n    'Rot', 'Lila', 'Blau',\n    'Orange', '', 'Türkis',\n    'Gelb', 'Lime', 'Grün'\n  ];\n  var color_element = [\n    1,  14,  4,\n    13, '', 24,\n    3, 23, 2\n  ];\n  */\n  var color_name = [\n    'Lime', 'Gelb', 'Orange',\n    'Grün', '', 'Rot',\n    'Türkis', 'Blau', 'Lila'\n  ];\n  var color_element = [\n    23, 3, 13,\n    2, '', 1,\n    24, 4, 14\n  ];\n  var color_text_black = [\n    1, 1, 1,\n    1,  , 1,\n    0, 0, 0\n  ];\n  var colormap = color.map;\n  var a = 80; // grid constant\n  var s = 10; // spacing\n  var f = 20; // font size\n  div_eight_colors.innerHTML += `\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"36mm\" height=\"36mm\"\n        viewBox=\"0 0 ${3*a+2*s} ${3*a+2*s}\"\n      >\n  ${color_element.map((element, i) => {\n    var x = i % 3;\n    var y = (i / 3) | 0; // |0 = round down to integer\n    if (i != 4) return `<rect fill=\"${colormap[element]}\" x=\"${x*(a+s)}\" y=\"${y*(a+s)}\" width=\"${a}\" height=\"${a}\" />`;\n  }).join('\\n')}    \n      <g\n        text-anchor=\"middle\"\n        dominant-baseline=\"central\"\n        font-size=\"${f}\"\n      >\n    ${color_name.map((name, i) => {\n      var x = i % 3;\n      var y = (i / 3) | 0; // |0 = round down to integer\n      const text_color = color_text_black[i] ? '#000000' : '#ffffff';\n      const text_weight = color_text_black[i] ? '' : 'bold'; // TODO use bold font or larger font size?\n      if (i == 4) return ''; // skip center of array\n      return `\n        <text fill=\"${text_color}\" font-weight=\"${text_weight}\" x=\"${(x+0.5)*(a+s)-0.5*s}\" y=\"${(y+0.5)*(a+s)-0.5*s -0.6*f}\">${color_element[i]}</text>\n        <text fill=\"${text_color}\" font-weight=\"${text_weight}\" x=\"${(x+0.5)*(a+s)-0.5*s}\" y=\"${(y+0.5)*(a+s)-0.5*s +0.6*f}\">${name}</text>\n      `;\n    }).join('\\n')}\n      </g>\n      </svg>\n  `;\n\n\n\n  if (false) {\n    // variant 2\n\n    var div_eight_colors = document.getElementById('div_eight_colors_v2');\n    /*\n    var color_name = [\n      'Rot', 'Lila', 'Blau',\n      'Orange', '', 'Türkis',\n      'Gelb', 'Lime', 'Grün'\n    ];\n    var color_element = [\n      1,  14,  4,\n      13, '', 24,\n      3, 23, 2\n    ];\n    */\n    var color_name = [\n      'Lime', 'Gelb', 'Orange',\n      'Grün', '', 'Rot',\n      'Türkis', 'Blau', 'Lila'\n    ];\n    var color_element = [\n      23, 3, 13,\n      2, '', 1,\n      24, 4, 14\n    ];\n    var color_text_black = [\n      1, 1, 1,\n      1,  , 0,\n      1, 0, 0\n    ];\n    var colormap = color.map_v2;\n    var a = 80; // grid constant\n    var s = 10; // spacing\n    var f = 20; // font size\n    div_eight_colors.innerHTML += `\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"36mm\" height=\"36mm\"\n          viewBox=\"0 0 ${3*a+2*s} ${3*a+2*s}\"\n        >\n    ${color_element.map((element, i) => {\n      var x = i % 3;\n      var y = (i / 3) | 0; // |0 = round down to integer\n      if (i != 4) return `<rect fill=\"${colormap[element]}\" x=\"${x*(a+s)}\" y=\"${y*(a+s)}\" width=\"${a}\" height=\"${a}\" />`;\n    }).join('\\n')}    \n        <g\n          text-anchor=\"middle\"\n          dominant-baseline=\"central\"\n          font-size=\"${f}\"\n        >\n    ${color_name.map((name, i) => {\n      var x = i % 3;\n      var y = (i / 3) | 0; // |0 = round down to integer\n      const text_color = color_text_black[i] ? '#000000' : '#ffffff';\n      const text_weight = color_text_black[i] ? '' : 'bold'; // TODO use bold font or larger font size?\n      if (i == 4) return ''; // skip center of array\n      return `\n        <text fill=\"${text_color}\" font-weight=\"${text_weight}\" x=\"${(x+0.5)*(a+s)-0.5*s}\" y=\"${(y+0.5)*(a+s)-0.5*s -0.6*f}\">${color_element[i]}</text>\n        <text fill=\"${text_color}\" font-weight=\"${text_weight}\" x=\"${(x+0.5)*(a+s)-0.5*s}\" y=\"${(y+0.5)*(a+s)-0.5*s +0.6*f}\">${name}</text>\n      `;\n    }).join('\\n')}\n        </g>\n        </svg>\n    `;\n  }\n\n\n\n\n\n\n  // postprocess: colorize <pre class=\"map16\">\n  document.querySelectorAll('pre.map16').forEach(pre => {\n    //const fragment = document.createDocumentFragment();\n    pre.innerHTML = pre.innerHTML.replace(/[1234ABCD]/g, char => {\n      return `<span class=\"color-${char}\">${char}</span>`;\n    });\n  });\n\n  // reorder pages for booklet printing\n  // TODO solve with CSS only?\n  // print settings:\n  //  * A4 landscape\n  //  * duplex + flip on short edge\n\n\n  function set_layout(layout) {\n    if (!(layout in layoutData)) {\n      layout = 'twopage'; // default layout\n    }\n\n    document.querySelector('#pages-container').classList.remove('booklet-grid');\n    document.querySelector('#pages-container').classList.remove('twopage-grid');\n    document.querySelectorAll('.layout-menu button').forEach(b => b.classList.remove('active'));\n\n    layoutData[layout].set();\n  }\n\n\n  //const toggle_link = document.getElementById('toggle-booklet-mode');\n\n  function parse_query() {\n  \n    const query = get_query();\n    \n    console.log(`query: ${Object.keys(query).map(key => `${key} = ${query[key]}`).join(' & ')}`);\n\n    set_layout(query.layout);\n    set_language(query.lang);\n  }\n\n\n\n  parse_query();\n  window.addEventListener('hashchange', event => parse_query(), {});\n\n\n\n  // detect darkreader style\n  // https://github.com/darkreader/darkreader/issues/4342\n  (() => {\n    const head = document.querySelector('head');\n    const handleMutation = () => {\n      const darkreaderSelector = 'meta[name=\"darkreader\"]';\n      //darkreaderSelector = 'style#dark-reader-style',\n      const darkreaderActive = (head.querySelector(darkreaderSelector) != null);\n      //console.log(`darkreader active? ` + darkreaderActive),\n      document.body.classList.toggle('dark-reader', darkreaderActive);\n    };\n    handleMutation();\n    new MutationObserver(handleMutation).observe(head, { childList: true });\n  })();\n\n} // handle_body_loaded\n"],"names":["print_size","print_orient","print_scale","page_x","page_y","page_margin","margin_size","color","map","4","3","1","2","24","23","13","14","map_v2","light","dark","text","medium","mapname","mapval","Object","keys","reduce","acc","key","styleString","id","document","querySelector","style2","createElement","appendChild","innerHTML","props","log","A","B","C","D","cssVarsOfColorMap","setPrintStyle","Array","prototype","contains","needle","this","indexOf","Number","mod","n","current_lang","lang","languages","Set","meta","split","has","shortLang","querySelectorAll","forEach","children","from","fragment","fragmentLanguages","node","add","localName","dir","style","display","b","classList","remove","query","action","target","getElementById","console","error","toggle","window","openModal","closeModal","layoutData","twopage","name","set","page_list","page_idx","Math","floor","length","page","entries","top_idx","sheet_of_page","left_idx","is_right_page","gridColumn","gridRow","booklet","num_pages","num_sheets","ceil","print_pages","is_sheet_back","is_page_center_left","linear","state","auditMode","showFiles","fromEntries","location","hash","slice","i","kv","filter","Boolean","handleChangeAuditMode","checked","handleChangeShowFiles","add_query","obj","new_query","assign","k","join","body","onload","meta2","meta3","content","docname","version","title","filename","get_meta","get_query","lang_list","addEventListener","event","preventDefault","sign","deltaY","layoutKey","layout","pattern","string","childNodes","nodes","nodeType","ELEMENT_NODE","replace","navigator","language","userLanguage","page_array","booklet_last_idx","page_div","span_page","span_license","span_title","homepage","middle","fire","earth","air","water","getElementsByTagName","outerHTML","e","pre","div","div_eight_colors","color_element","color_text_black","colormap","query2","element","x","y","text_color","text_weight","char","parse_query","head","handleMutation","darkreaderActive","MutationObserver","observe","childList"],"mappings":"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"}